<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistical models : linking data to theory</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sara Mortara &amp; PI" />
    <meta name="date" content="2024-01-29" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <script src="libs/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy code <i class=\"fa fa-clipboard\"><\/i>","success":"Copied! <i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"Not copied üòï <i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="libs/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.min.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/viz/viz.js"></script>
    <link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding/grViz.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistical models : linking data to theory
]
.subtitle[
## Presentation - a brief tour on statistical models
]
.author[
### Sara Mortara &amp; PI
]
.date[
### 29 Jan 2024
]

---






## Who we are (in order of appearance)
### A bunch of biologists ...

&lt;center&gt;

.pull-left[
&lt;img src="figs/sara.jpg" width="50%" /&gt;

**Sara**, Sara Mortara (she/her)
]



.pull-left[
&lt;img src="figs/PI.jpg" width="40%" /&gt;

**PI**, Paulo In√°cio Prado (he/him)
]



---
## Who we are (in order of appearance)

&lt;center&gt;

.pull-left[

&lt;img src="figs/diogo.jpg" width="50%" /&gt;

**Diogro**, Diogo Melo (he/him)
]

.pull-right[

### ... trying to help you to learn statistical modelling faster and easier than we did 

]


---
## Who we are
### Professors who also have contributed to this course

&lt;center&gt;


.pull-left[
&lt;img src="figs/paulinha.jpg" width="50%" /&gt;

**Paulinha**, Paula Lemos da Costa (she/her)
]


.pull-right[
&lt;img src="figs/andrea.jpg" width="50%" /&gt;

**Andrea**, Andrea S√°nchez-Tapia (she/her)
]


---
## What we want

 - To help you to be good users of statistical models in ecological research
 
 - To make you learn this faster and easier than we did
 
 - In doing that, to improve our own knowledge on statistical models


&lt;center&gt;
.left-column[
&lt;img src="figs/Painel.Paulo.Freire_cropped.JPG" width="100%" /&gt;
]
&lt;/center&gt;

.right-column[
&gt; "Ningu√©m educa ningu√©m, ningu√©m educa a si mesmo, os homens se educam entre si, mediatizados pelo mundo"
&gt;
&gt; Paulo Freire
]


---

## Course overview

&lt;center&gt;



<div id="htmlwidget-332fdb39362a3d7ea53d" style="width:1024px;height:504px;" class="grViz html-widget "></div>
<script type="application/json" data-for="htmlwidget-332fdb39362a3d7ea53d">{"x":{"diagram":"\ndigraph nicegraph {\n\n  bgcolor = \"#fdf6e3\"\n\n  # graph, node, and edge definitions\n  graph [compound = true, nodesep = .5, ranksep = .25,\n         color = \"#dc322f\"]\n\n  node [fontname = Helvetica, fontcolor = darkslategray,\n        shape = rectangle, fixedsize = false, \n        color = \"#586e75\", fontsize = 30]\n\n  edge [color = grey, arrowhead = none, arrowtail = none]\n\n  # subgraph for fondation\n  subgraph cluster0 {\n    node [fixedsize = true, width = 4.3, fontsize = 22]\n    \"Presentation\" -> \"Probability distributions\" -> \"Bayesian statistics I\" \n  }\n\n  # subgraph for tools\n  subgraph cluster1 {\n    node [fixedsize = true, width = 4.3, fontsize = 22]\n    \"Linear models\" -> \"Multiple regression\" -> \"Generalized linear models\" -> \"Mixed and hierarchical models\" \n  }\n  \n    # subgraph inference\n  subgraph cluster2 {\n    node [fixedsize = true, width = 4.3, fontsize = 22]\n    \"Bayesian statistics II\" -> \"Causal thinking\"\n  }\n\n\n  \"Statistical modeling\"             [width = 5, fontsize = 30, height = 0.75, style = filled, fillcolor = \"#cb4b16\", fontcolor = \"#fdf6e3\"]\n  \"Foundation\" [fontsize = 24, style = filled, fillcolor = dimgray, fontcolor = \"#fdf6e3\", width = 4.4, height = 0.6]\n  \"Fitting\" [fontsize = 24, style = filled, fillcolor = dimgray, fontcolor = \"#fdf6e3\", width = 4.4, height = 0.6]\n  \"Inference\" [fontsize = 24, style = filled, fillcolor = dimgray, fontcolor = \"#fdf6e3\", width = 4.5, height = 0.6]\n\n  \"Statistical modeling\" -> \"Foundation\" \n  \"Statistical modeling\" -> \"Fitting\"\n  \"Statistical modeling\" ->   \"Inference\" \n  \"Foundation\" -> \"Presentation\"            [lhead = cluster0]\n  \"Fitting\" -> \"Linear models\"        [lhead = cluster1]\n  \"Inference\" -> \"Bayesian statistics II\"        [lhead = cluster2]\n\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>

&lt;/center&gt;


---

## Teaching strategies

.pull-left[


- Lectures and computer labs
 
- Labs: tutorials in R language
  - Virtual machine: [http://34.139.106.91:8787/]()
 
- Q&amp;A (in your preferred language)

- Office hours if possible (and if interest you)
 
- All resources at https://statistical-modeling.github.io/2024
 
- Learning resources will be available as we progress

]
 
 .pull-right[

&lt;img src="figs/autonomia.jpg" width="896" style="display: block; margin: auto;" /&gt;
 
]
 

---
## Course schedule

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Week &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Time &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Monday &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Tuesday &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Wednesday &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Thursday &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Friday &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 09:00-10:30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Course presentation &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Probability distributions lab &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Linear models &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Linear models lab &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Maximum likelihood fitting - I &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11:00-12:30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Probability distributions &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Q&amp;amp;A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Multiple regression and model comparison &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Q&amp;amp;A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Maximum likelihood fitting lab &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 09:00-10:30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Bayesian statistics - I &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Bayesian fitting lab &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Causal thinking and model building &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Generalized linear models &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mixed and hierachical models &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 11:00-12:30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Bayesian statistics - II &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Q&amp;amp;A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Causal thinking Lab &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Q&amp;amp;A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mixed and hierachical models lab &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
## Course roadmap

&lt;img src="figs/roadmap.png" width="80%" style="display: block; margin: auto;" /&gt;


---
## Linking data and theory

.pull-left[
&lt;img src="figs/isaias_sales.jpeg" width="896" style="display: block; margin: auto;" /&gt;

Ib√£ Huni Kuin, Nai Basa Masheri, 2014
]

.pull-right[

How do we address ecological problems characterized by complexity and uncertainty?

+ Use a **model** to simplify

+ **Theories**: summarize the understanding of how

+ **Hypotheses**: proposed explanations of how

+ **Data**: measurable variables carrying uncertainty

+ **Statistical models** confront theories with data

]


---
## Use a model to simplify


.pull-left[

### Darwin's theory of coral atolls

&lt;img src="figs/Atoll_Formation.png" width="1067" /&gt;

]

.pull-right[
&lt;img src="figs/atoll_new.jpg" width="95%" /&gt;

]


---
## Modeling goals in Ecology

&lt;img src="figs/Tredennick_etal.png" width="768" style="display: block; margin: auto;" /&gt;



---
## What is the relation of species number to area?


&lt;img src="figs/archipel-stockholm.jpg" width="50%" style="display: block; margin: auto;" /&gt;

&gt; Both for the plant-geographer and the ecologist it is of great importance to know if an area or a district is rich or poor from the point of view of vegetation

O. Arrhenius 1921. **Species and area**


---
## What is the relation of species number to area?

&lt;img src="figs/Schneider_Fig1_2.png" width="65%" style="display: block; margin: auto;" /&gt;

---

## What is a statistical model?
.bg-white.b--brblack.ba.bw2.br3.shadow-5.ph4.mt1[
A description of how **your data** should behave according to some theory

Thus, statistical models are hypotheses about how a given **data set** was generated
]

--

## Why is this different from a mathematical model?
.bg-white.b--brblack.ba.bw2.br3.shadow-5.ph4.mt1[Mathematical
models describe the behavior of **theoretical quantities**

Statistical models describe the behavior of **measurements** used to express 
theoretical quantities]


---
## What we expect from theory?

.pull-left[
### MacArthur &amp; Wilson 
- Large areas support larger population sizes of all resident species than do small islands

- Probability of stochastic extinction is reduced on large islands

- Island area &gt; Number of individuals &gt; Species number
]

.pull.right[

&lt;img src="figs/theory.png" width="50%" style="display: block; margin: auto;" /&gt;


]


---
## What we expect from theory?


.pull-left[
### Birds of the East Indies

Preston 1961

&lt;img src="figs/1-Lesser.jpeg" width="60%" /&gt;


]

.pull-right[

&lt;img src="figs/expect.png" width="90%" /&gt;

]

---
## What the data shows


.pull-left[
&lt;img src="figs/data_plot.png" width="90%" style="display: block; margin: auto;" /&gt;

]

.pull-right[
&lt;img src="figs/data_plot2.png" width="90%" style="display: block; margin: auto;" /&gt;

]

---
class: middle

### Empirical data, a.k.a. random variables

.bg-white.b--brblack.ba.bw2.br3.shadow-5.ph4.mt1[

* We can never control all sources of variation that affect our measurements or counts

* Thus, any measurement or count done in a scientific research has some degree of **uncertaintity**

* In other words, any quantitative data of scientific interest is a **random variable** 

]


---
### From the mathematical to the statistical model

.pull-left[

- We can not assure the exact value of a random variable but we can
   think on how likely would be each possible value

- A simple hypothesis: large departures from the theoretical
   expectation are less likely than small ones
   
- In this approach data is partitioned into **expected values** and 
  **unexplained variation** (a.k.a. *"residual"*, *"error"* or *"noise"*)

- `\(Data = mean(Y) + Residual\)`

]

.pull-right[
&lt;img src="figs/expect_variation.png" width="2400" style="display: block; margin: auto;" /&gt;


]

---
## The normal or Gaussian probability distibution

.pull-left[
* Ascribes a probability to each value a measurement can assume

* It is a model for the sum of many sources of variation

* Small deviations from the expected value are more likely than large deviations

* The probabilities of the deviations are symmetrical around the expected value
]


.pull-right[
.center[
&lt;img src="figs/dnorm.png" width="90%" /&gt;
]]
	
---
## The normal distribution is a statistical model

.pull-left[
$$\mathcal{N}(\mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi}}\;e^{-\frac{1}{2}\left(\frac{Y-\mu}{\sigma}\right)^2} $$

**Where:**
* `\(Y\)`: the value of a measurement 
* `\(\mu\)`: the expected value
* `\(\sigma\)`: the standard deviation

** Notation**:

* `\(Y \sim \mathcal{N}(\mu, \sigma)\)` means *" `\(Y\)` is a random variable that follows a normal distribution"*

]

.pull-right[
.center[
&lt;img src="figs/dnorm2.png" width="90%" /&gt;
]]


---
## A syntax for statistical models


.pull-left[

**Our model:**

$$ 
`\begin{aligned}
Y(i)^* &amp; \sim \mathcal{N}(\mu, \sigma) \\[1em]
log(\mu) &amp; =  log(cA^z) \\[1em]
log(\mu) &amp; = log(c) + zlog(A) \\[1em] 
\mu^* &amp; = c^* + zA^* \\[1em] 
\sigma &amp; = C
\end{aligned}`
$$
]

.pull-right[

`\(S = cA^z\)`

**Which reads:** "The log of the number of species at each island `\(Y(i)\)` follows a normal distribution with expected value `\(\mu\)` that is a function of area `\(A_i\)`, and with a standard deviation `\(\sigma\)` of constant value `\(C\)`"

]

---
## What's next?

.pull-left[

**Model fitting:** 
use the data to find the best guesses for the free parameters of the model ( `\(c\)`, `\(z\)` )

**Inference**: 
Use the guessed parameters and the fitted model to learn about the study system and to make predictions

**Model selection**: fit alternative models and compare them


]

.pull-right[

&lt;img src="figs/expect_variation2.png" width="2400" style="display: block; margin: auto;" /&gt;

]


---
## Linear regression: a model to rule them all


* All statistical model has a  mathematical expression that
  describes the expected behavior of a **response** or **dependent
  variable**
  
--

* The simplest mathematical behavior is a linear relationship: the
response is proportional to other measurements (known as a **predictor**
or **independent variables**)

--

* **Linear regression** is the statistical model that describe proportionalities

--

* Linear regression is a foundational statistical model, from which a
  lot of other models were developed
  
--

* Thus, it is general a good idea to deduce linear relationships from
  your theoretical models and then fit a linear regression. Next we
  will show an example with the logistic equation

---
## What we expect from theory

.pull-left[

$$ 
`\begin{aligned}
Y(i) &amp; \sim \mathcal{N}(\mu, \sigma) \\[1em]
log(\mu) &amp; =  log(cA^z) \\[1em]
log(\mu) &amp; = log(c) + zlog(A) \\[1em] 
\mu^* &amp; = c^* + zA^* \\[1em] 
\sigma &amp; = C
\end{aligned}`
$$
The log of species richness is a linear function of the log of island area

]

.pull-right[

&lt;img src="figs/theory_log.png" width="90%" style="display: block; margin: auto;" /&gt;


]

---
## Which data do we need? `\(S = cA^z\)`

- The log of the number of species per island ( `\(S\)` ) -&gt; **response variable**
--


- The log of the area of each island ( `\(A\)` ) -&gt; **predictor variable**
--


---
## The linear regression model

.pull-left[

*Our model:*

$$ 
`\begin{aligned}
Y(i) &amp; \sim \mathcal{N}(\mu, \sigma) \\[1em]
\mu^* &amp; = c^* + zA^* \\[1em] 
\sigma &amp; = C
\end{aligned}`
$$

*Which reads:*
The log of species richness across islands `\(Y(i)\)` follows a normal distribution with expected value `\(\mu\)` that is a linear function of the log of island area, with a standard deviation `\(\sigma\)` of constant value `\(C\)`

]

.pull-right[

&lt;img src="figs/theory3.png" width="90%" style="display: block; margin: auto;" /&gt;


]

---
### What the fit shows

.pull-left[

```r
# Fit of the linear model of the log of 
# species as a linear function of the 
# log of area
lm(log(species) ~ log(area), 
   data = df)
```

```
## 
## Call:
## lm(formula = log(species) ~ log(area), data = df)
## 
## Coefficients:
## (Intercept)    log(area)  
##      1.7467       0.3498
```

]


.pull.right[

&lt;img src="figs/fit.png" width="40%" style="display: block; margin: auto;" /&gt;

]

---
## Estimated parameters `\(S = cA^z\)`

.pull-left[




```r
mod &lt;- lm(log(species) ~ log(area), data = df)
coef(mod)
```

```
## (Intercept)   log(area) 
##   1.7467150   0.3498288
```

`\(c = \exp(1.75)\)` 

`\(z = 0.35\)`

`\(S = 5.75 \times 8870 ^ {0.35}\)`

`\(S = 138.4972\)`


]


.pull.right[

&lt;img src="figs/fit.png" width="40%" style="display: block; margin: auto;" /&gt;

]

---
## Where we are and what is next?


&lt;img src="figs/roadmap.png" width="80%" style="display: block; margin: auto;" /&gt;

---

## Further reading

* **Quantitative Reasoning in Ecology**: Chapter 1 in Schneider,
    D. 2009. Quantitative Ecology: Measurement, Models, and
    Scaling. New York, Academic Press, 2nd Ed.
    
    
* **Alternative views of scientific method and of modelling**:
    Chapter 2 in Hilborn, R &amp; Mangel, M. 1997. The Ecological
    Detective - Confronting Models with Data. Princeton, Princeton
    University Press. 
    
* **Approaches to ecological modelling**: Chapter 1 in Ovaskeinen 
    et al. 2016. Quantitative Ecology and Evolutionary Biology. 
    Oxford, Oxford University Press.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
